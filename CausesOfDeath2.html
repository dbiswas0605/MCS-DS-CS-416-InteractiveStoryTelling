<!DOCTYPE html>
<script src="https://d3js.org/d3.v4.js"></script>
<script src ="./Javascripts/dropdown.js"></script>
<link rel="stylesheet" href="./CSS/dropdown.css">

<html lang = "en">
<body>
    <p>Leading causes of death</p>

      

    <div id="my_dataviz"></div>
    

    <script>


        d3.csv("./Data/annual-number-of-deaths-by-cause_2.csv", function(data)
        {
            DrawChart(data, 1995);
        });

        function DrawChart(data, currentYearParam)
        {
            var margin = {top:15, left:150, right:50, botton:30};
            var width = 600 - margin.left - margin.right;
            var height = 500 - margin.top - margin.botton;

                var causeData = GetYearData(data, currentYearParam);
                var causes = GetCauses(data);

                var domainStart = d3.min(causeData)
                var domainEnd = d3.max(causeData)

                // append the svg object to the body of the page
                var svg = d3.select("#my_dataviz")
                    .append('svg')
                    .attr('width', width + margin.left + margin.right)
                    .attr('height', height + margin.top + margin.botton)
                    .style('background-color', '#D3D3D3')
                    .append("g")
                    .attr("transform",
                    "translate(" + margin.left + "," + margin.top + ")");


                // X axis
                var x = d3.scaleLog()
                    .domain([domainStart, domainEnd])
                    .range([ 0, width]);

                svg.append("g")
                    .attr("transform", "translate(0," + height + ")")
                    .call(d3.axisBottom(x).tickFormat((d) => '').tickSize(0))

                   


                // Y axis
                var yaxis = d3.scaleBand()
                .domain(causes)    
                .range([ 0, height ])
                    
                    //.padding(.1);


                svg.append("g")
                    .call(d3.axisLeft(yaxis))

                    console.log(causeData);

                    var y = d3.scaleLinear()
                    .domain([0, 20])
                    .range([ 0, height ])
                    
                    //.padding(.1);

                    var yColor = d3.scaleLinear().domain([0,20]).range(['red','blue']); 
                //Bars
                svg.selectAll("rect")
                    .data(causeData)
                    .enter()
                    .append("rect")
                    .attr("x", 0)
                    .attr("y", function(d, i) { return y(i) + 5})
                    .attr("width", function(d) { return x(d); })
                    .attr("height", 15 )
                    .style('fill', function(d,i) {return yColor(i)})

                
                    svg.append('rect')
                    .attr('x',-120)
                    .attr('y',5)
                    .attr('height',50)
                    .attr('width',550)
                    .style('opacity', 0.5)
                    .style('fill', 'orange')
                    .transition()
                    .duration(2000)
                    .style('fill', 'red')

                    svg.append('text')
                    .attr('x',-120)
                    .attr('y',5)
                    .append('tspan')
                    .attr("text", "hello")






        }


        function GetYearData(data, currentYearParam)
        {
            return data.map(function(d) { return parseInt(d[currentYearParam])})
        }

        function GetCauses(data)
        {
            return data.map(function(d) { return d.Cause; })
        }


    </script>
</body>

</html>
